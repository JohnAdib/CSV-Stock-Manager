// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Stock {
  id          Int      @id @default(autoincrement())
  quantity    Int
  sku         String   @unique
  description String?
  store       String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  csvFileId   Int?
  csvFileLog  CsvFileLog? @relation(fields: [csvFileId], references: [id], onDelete: SetNull)

  @@index([quantity])
  @@index([store])
  @@index([quantity, store])
}

model CsvFileLog {
  id           Int      @id @default(autoincrement())
  fileName     String
  fileSize     Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  totalRecords Int
  successCount Int
  invalidCount Int
  upsertFailedCount  Int
  // status: 'UPLOADED' | 'PROCESSING' | 'SUCCESS' | 'PARTIAL' | 'FAILED'
  // SQLLite does not support ENUM, so we use String instead and validate the value in the app
  status       String

  stocks       Stock[]

  @@index([status])
}
